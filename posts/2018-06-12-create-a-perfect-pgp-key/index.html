<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=author content="dvogt"><meta name=description content="personal developer blog for some coding notes."><meta name=keywords content="blog,tech,develop,software,coding"><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><link rel=canonical href=/posts/2018-06-12-create-a-perfect-pgp-key/><base href=/><meta property="og:title" content="Create a perfect pgp key"><meta property="og:description" content="Some aggregate notes about creating a pgp key"><meta property="og:type" content="article"><meta property="og:url" content="/posts/2018-06-12-create-a-perfect-pgp-key/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-06-12T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-16T08:21:16+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Create a perfect pgp key"><meta name=twitter:description content="Some aggregate notes about creating a pgp key"><meta itemprop=name content="Create a perfect pgp key"><meta itemprop=description content="Some aggregate notes about creating a pgp key"><meta itemprop=datePublished content="2018-06-12T00:00:00+00:00"><meta itemprop=dateModified content="2025-01-16T08:21:16+00:00"><meta itemprop=wordCount content="640"><meta itemprop=keywords content="linux,security,pgp,"><link rel=stylesheet href=css/layout.css><link rel=stylesheet href=css/syntax.css><link rel=stylesheet href=css/tweet.css><style type=text/css>body{background-color:#202020;color:#dbdbdb}a{color:#dbdbdb}pre{background:#1d1f21;border:1px solid #dbdbdb;border-radius:5px}code{background:#1d1f21}blockquote{background:#1d1f21;border-left:3px solid #dbdbdb}table{margin:1em auto;border-collapse:collapse}table,th,td{border:1px solid #dbdbdb}th{background:#dbdbdb;color:#202020}.siteTitle a{color:#b3b6b7}.post .content h1{color:#b3b6b7}.post .content h2{color:#b3b6b7}.post .content h3{color:#b3b6b7}.post .content h4{color:#b3b6b7}.post .content h5{color:#b3b6b7}.post .content h6{color:#b3b6b7}.post .content a:hover{color:#b3b6b7}.social-link:hover{color:#b3b6b7}.nav-item-title:hover{color:#b3b6b7}.tag a:hover{color:#b3b6b7}.copyright{color:#404040}.poweredby{color:#404040}.poweredby a{color:#404040}.post-preview .title a{color:#b3b6b7}.content-item a:hover{text-decoration:underline;color:#b3b6b7}.post-list .title{color:#b3b6b7}.rmore{color:#b3b6b7}.terms .term a:hover{text-decoration:underline;color:#b3b6b7}</style><script async defer data-website-id=aeec65b5-9542-46f0-bd03-fa96813535bb src=https://umami.vogt.dev/umami.js></script><title>Create a perfect pgp key</title></head><body><div class=main><header><div class=header-bar><nav><div class=siteTitle><a href=/>dima.</a></div><a class=nav-item href=/now/><div class=nav-item-title>now</div></a><a class=nav-item href=/toots/><div class=nav-item-title>tweets</div></a><a class="nav-item
active" href=/posts><div class=nav-item-title>blog</div></a><a class=nav-item href=/><div class=nav-item-title>web</div></a><a class=nav-item href=/tags/><div class=nav-item-title>tags</div></a><a class=nav-item href=/index.xml><div class=nav-item-title>rss</div></a></nav></div><div class=social-links-header></div></header><article class=post><h1 class=title>Create a perfect pgp key</h1><p class=description>Some aggregate notes about creating a pgp key</p><div class=content><p>Maybe I already said that I&rsquo;m a big fan of pass. A small unix tool (bash-script) for managing passwords with a pgp-key. In this note I collected some introductions for a best practise.</p><p>The goals in this post are create a pgp master key with multiple id and a subkey.</p><h3 id=gpg-config>GPG config</h3><p>At first, some gpg config stuff here. [1]<br>Update your <code>~/.gnupg/gpg.conf</code> and kill your actually running gpg-agent <code>killall gpg-agent</code></p><pre tabindex=0><code># Avoid information leaked
no-emit-version
no-comments
export-options export-minimal

# Displays the long format of the ID of the keys and their fingerprints
keyid-format 0xlong
with-fingerprint

# Displays the validity of the keys
list-options show-uid-validity
verify-options show-uid-validity

# Limits the algorithms used
personal-cipher-preferences AES256
personal-digest-preferences SHA512
default-preference-list SHA512 SHA384 SHA256 RIPEMD160 AES256 TWOFISH BLOWFISH ZLIB BZIP2 ZIP Uncompressed

cipher-algo AES256
digest-algo SHA512
cert-digest-algo SHA512
compress-algo ZLIB

disable-cipher-algo 3DES
weak-digest SHA1

s2k-cipher-algo AES256
s2k-digest-algo SHA512
s2k-mode 3
s2k-count 65011712
</code></pre><h3 id=create-pgp-key>Create pgp key</h3><p>Create a master pgp key:</p><pre tabindex=0><code>$ gpg --expert --full-gen-key
</code></pre><p>Chose the ECC Nist P-256 algorithm without expiration and only certify action for the master key.</p><pre tabindex=0><code>[...]
  (11) ECC (set your own capabilities)
  (13) Existing key
Your selection? 11

Possible actions for a ECDSA/EdDSA key: Sign Certify Authenticate
Current allowed actions: Certify

   (S) Toggle the sign capability
   (A) Toggle the authenticate capability
   (Q) Finished

Your selection? q
Please select which elliptic curve you want:
   (1) Curve 25519
   (3) NIST P-256
[...]
Your selection? 3
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0) 0
Key does not expire at all
Is this correct? (y/N) y
</code></pre><p>Input your personal information for the key creation process.</p><pre tabindex=0><code>GnuPG needs to construct a user ID to identify your key.

Real name: Dimitrij Vogt
Email address: mail@dima23.de
Comment: master
You selected this USER-ID:
    &#34;Dimitrij Vogt (master) &lt;mail@dima23.de&gt;&#34;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
[...]
</code></pre><p>Add an another uid (email address) to your key.[4]</p><pre tabindex=0><code> $ gpg --edit-key mail@dima23.de
</code></pre><pre tabindex=0><code>[...]
gpg&gt; adduid
[...]
gpg&gt; save
</code></pre><p>To change you primary uid of your key, follow this commands in edit mode:</p><pre tabindex=0><code>[...]
gpg&gt; uuid 2
[...]
gpg&gt; primary
[...]
gpg&gt; save
</code></pre><h3 id=add-subkey>Add subkey</h3><p>Add a subkey to your master key for some security approaches. Add a subkey for every action like authenticate, encrypt and so on.</p><pre tabindex=0><code>gpg&gt; addkey
</code></pre><h3 id=sign-new-key-with-old-key>Sign new key with old key</h3><pre tabindex=0><code> $ gpg --default-key &lt;old-key-id&gt; --sign-key &lt;new-key-id&gt;
</code></pre><pre tabindex=0><code>[...]
Really sign? (y/N) y
[...]
</code></pre><h3 id=create-a-revocation>Create a revocation</h3><p>A revocation is import, if you lost some of your keys.</p><pre tabindex=0><code> $ gpg --output mail@dima23.de.gpg-revocation --gen-revoke mail@dima23.de
</code></pre><h3 id=export-your-keys>Export your keys</h3><p>Export your public and priavte keys and protect them togehter with the revocation key on a safe place.</p><pre tabindex=0><code> $ gpg --export-secret-keys --armor mail@dima23.de &gt; mail@dima23.de.private.gpg-key
 $ gpg --export-keys --armor mail@dima23.de &gt; mail@dima23.de.public.gpg-key
</code></pre><h3 id=export-to-another-device>Export to another device</h3><p>If want to use some of the subkeys on another devices, you have to remove the master private before. Thats a little bit tricky, if you want to do it securly. Alex Cabal[1] have a good approach to do it, with a temporary mounted ram folder.</p><pre tabindex=0><code> $ mkdir /tmp/gpg
 $ sudo mount -t ramfs -o size=1M ramfs /tmp/gpg
 $ sudo chown $(logname):$(logname) /tmp/gpg
 $ gpg --export-secret-subkeys mail@dima23.de &gt; /tmp/gpg/subkeys
</code></pre><p>Delete the signing key from the keypair:</p><pre tabindex=0><code> $ gpg --delete-secret-key mail@dima23.de
</code></pre><p>Re-import the subkeys back to gpg from tmp:</p><pre tabindex=0><code> $ gpg --import /tmp/gpg/subkeys
</code></pre><p>Remeber to remove the temporary dir:</p><pre tabindex=0><code> $ sudo umount /tmp/gpg
 $ rm -rf /tmp/gpg
</code></pre><p>After import the subkeys and list the secret keys, your key is marked with a # cause the signing key is missed.</p><h3 id=send-key-to-key-server>Send key to key server</h3><pre tabindex=0><code> $ gpg --keyserver pgp.mit.edu --send-key &lt;new-key-id&gt;
</code></pre><h4 id=sources>Sources</h4><p>[1] <a href=https://alexcabal.com/creating-the-perfect-gpg-keypair/>alex_cabal-the-perfect-gpg-keypair</a><br>[2] <a href=https://blog.eleven-labs.com/en/openpgp-almost-perfect-key-pair-part-1>OpenPGP-The almost perfect key pair</a><br>[3] <a href=https://riseup.net/ru/security/message-security/openpgp/best-practices>rise_up-best_practise</a><br>[4] <a href=https://ekaia.org/blog/2009/05/10/creating-new-gpgkey/>Ana Guerrero López</a></p></div><footer class=post-footer>Please comment @github: <a href="https://github.com/dvogt23/blog/issues/new?labels=comment&amp;title=Page: Create%20a%20perfect%20pgp%20key" target=_blank>comment</a></footer></article><footer><div class=copyright>© dima 2018</div><div class=poweredby><a href=https://gohugo.io/ target=_blank>hugo</a>/<a href=https://github.com/gyorb/hugo-dusk target=_blank>hugo-dusk</a></div></footer></div></body></html>