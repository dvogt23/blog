<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=author content="dvogt"><meta name=description content="personal developer blog for some coding notes."><meta name=keywords content="blog,tech,develop,software,coding"><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><link rel=canonical href=/post/2018-12-11-tmux-pair-programming/><base href=/><meta property="og:title" content="Pair programming with tmux"><meta property="og:description" content="Create a secure login to your tmux session"><meta property="og:type" content="article"><meta property="og:url" content="/post/2018-12-11-tmux-pair-programming/"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-12-11T00:00:00+00:00"><meta property="article:modified_time" content="2018-12-11T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pair programming with tmux"><meta name=twitter:description content="Create a secure login to your tmux session"><meta itemprop=name content="Pair programming with tmux"><meta itemprop=description content="Create a secure login to your tmux session"><meta itemprop=datePublished content="2018-12-11T00:00:00+00:00"><meta itemprop=dateModified content="2018-12-11T00:00:00+00:00"><meta itemprop=wordCount content="379"><meta itemprop=keywords content="linux,tmux,pair-programming,ssh,development,programming,"><link rel=stylesheet href=css/layout.css><link rel=stylesheet href=css/syntax.css><link rel=stylesheet href=css/tweet.css><style type=text/css>body{background-color:#202020;color:#dbdbdb}a{color:#dbdbdb}pre{background:#1d1f21;border:1px solid #dbdbdb;border-radius:5px}code{background:#1d1f21}blockquote{background:#1d1f21;border-left:3px solid #dbdbdb}table{margin:1em auto;border-collapse:collapse}table,th,td{border:1px solid #dbdbdb}th{background:#dbdbdb;color:#202020}.siteTitle a{color:#b3b6b7}.post .content h1{color:#b3b6b7}.post .content h2{color:#b3b6b7}.post .content h3{color:#b3b6b7}.post .content h4{color:#b3b6b7}.post .content h5{color:#b3b6b7}.post .content h6{color:#b3b6b7}.post .content a:hover{color:#b3b6b7}.social-link:hover{color:#b3b6b7}.nav-item-title:hover{color:#b3b6b7}.tag a:hover{color:#b3b6b7}.copyright{color:#404040}.poweredby{color:#404040}.poweredby a{color:#404040}.post-preview .title a{color:#b3b6b7}.content-item a:hover{text-decoration:underline;color:#b3b6b7}.post-list .title{color:#b3b6b7}.rmore{color:#b3b6b7}.terms .term a:hover{text-decoration:underline;color:#b3b6b7}</style><script async defer data-website-id=aeec65b5-9542-46f0-bd03-fa96813535bb src=https://umami.vogt.dev/umami.js></script><title>Pair programming with tmux</title></head><body><div class=main><header><div class=header-bar><nav><div class=siteTitle><a href=/>blog</a></div><a class=nav-item href=/now/><div class=nav-item-title>now</div></a><a class=nav-item href=/toots/><div class=nav-item-title>tweets</div></a><a class=nav-item href=https://vogt.dev><div class=nav-item-title>web</div></a><a class=nav-item href=/tags/><div class=nav-item-title>tags</div></a><a class=nav-item href=/index.xml><div class=nav-item-title>rss</div></a></nav></div><div class=social-links-header></div></header><article class=post><h1 class=title>Pair programming with tmux</h1><p class=description>Create a secure login to your tmux session</p><div class=content><p>The simpliest way to develop over the network with a colleague or friend in a
secure way, is to use ssh[1] and tmux[2]. An alternative is to use a very
popular tool named tmate[3]. In my opinion, it is not necessary, because it is
so simple to create a new user on your machine and to share your tmux session
with them. Only if you haven&rsquo;t a ssh incoming routing, you may use another way.
Here is a step-by-step guide to create a user and share your tmux session:</p><h3 id=requirements>Requirements</h3><p>Install the following packages on your machine:</p><pre tabindex=0><code>tmux        # terminal multiplexer
openssh     # ssh daemon
</code></pre><p>and the ssh port forwarded to your machine.</p><h3 id=create-user-and-group>Create user and group</h3><pre tabindex=0><code>$ groupadd shared               # create group &#34;shared&#34;
$ useradd tmux                  # create user &#34;tmux&#34;
$ usermod -a -G shared tmux     # add user tmux to group shared
$ usermod -a -G shared $USER    # add your current user to group
$ passwd tmux                   # set pass for user tmux
$ mkdir /home/tmux              # create home dir for tmux
</code></pre><h3 id=share-a-tmux-session>Share a tmux session</h3><p>I have created a little script for sharing a new tmux session</p><p><em><strong>tmuxshare</strong></em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! pgrep -x <span style=color:#e6db74>&#34;sshd&#34;</span> &gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Start ssh daemon...&#34;</span> <span style=color:#f92672>&amp;&amp;</span> sudo systemctl start sshd.service
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>tmux -S /tmp/shared -f ~/.tmux.conf new -s shared -d
</span></span><span style=display:flex><span>chgrp shared /tmp/shared
</span></span><span style=display:flex><span>tmux -S /tmp/shared attach
</span></span></code></pre></div><p>for joining a tmux session, the thmux user have to run the <code>tmuxjoin</code> script</p><p><em><strong>tmuxjoin</strong></em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>[[</span> -e /tmp/shared <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> tmux -S /tmp/shared attach
</span></span></code></pre></div><p>To run this script automatically after user login, put this line to the
<code>.bash_profile</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[[</span> -e /tmp/shared <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> ~/tmuxjoin
</span></span></code></pre></div><p><em><strong>EDIT:</strong></em>
For sharing your current session, I modified the scripts as follows:</p><p><em><strong>tmuxshare</strong></em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>CURRENT<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $TMUX | cut -f1 -d<span style=color:#e6db74>&#39;,&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>SESSION<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $TMUX | cut -f3 -d<span style=color:#e6db74>&#39;,&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! pgrep -x <span style=color:#e6db74>&#34;sshd&#34;</span> &gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Start ssh daemon...&#34;</span> <span style=color:#f92672>&amp;&amp;</span> sudo systemctl start sshd.service
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>chgrp shared <span style=color:#e6db74>&#34;</span>$CURRENT<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>chgrp shared <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>dirname $CURRENT<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>0770</span> -R <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>dirname $CURRENT<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$CURRENT<span style=color:#e6db74>,</span>$SESSION<span style=color:#e6db74>&#34;</span> &gt; /tmp/shared.current
</span></span></code></pre></div><p><em><strong>tmuxjoin</strong></em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -e /tmp/shared.current <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    SOCKET<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat /tmp/shared.current | cut -f1 -d<span style=color:#e6db74>&#39;,&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    SESSION<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat /tmp/shared.current | cut -f2 -d<span style=color:#e6db74>&#39;,&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    tmux -S <span style=color:#e6db74>&#34;</span>$SOCKET<span style=color:#e6db74>&#34;</span> attach -t <span style=color:#e6db74>&#34;</span>$SESSION<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[[</span> -e /tmp/shared <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> tmux -S /tmp/shared attach
</span></span></code></pre></div><h4 id=sources>Sources</h4><p>[1] <a href=https://www.openssh.com>OpenSSH</a><br>[2] <a href=https://github.com/tmux/tmux>TMUX</a><br>[3] <a href=https://tmate.io>tmate.io</a></p></div><footer class=post-footer>Please comment @github: <a href="https://github.com/dvogt23/blog/issues/new?labels=comment&amp;title=Page: Pair%20programming%20with%20tmux" target=_blank>comment</a></footer></article><footer><div class=copyright>© dima 2018</div><div class=poweredby><a href=https://gohugo.io/ target=_blank>hugo</a>/<a href=https://github.com/gyorb/hugo-dusk target=_blank>hugo-dusk</a></div></footer></div></body></html>